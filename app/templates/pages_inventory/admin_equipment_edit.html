{% extends 'base/base_admin.html' %}
{% block title %}แก้ไขอุปกรณ์{% endblock %}
{% set CATEGORIES = ["กล้อง","สายไฟ","ไมโครคอนโทรลเลอร์","จอภาพ","ไมโครโฟน","อุปกรณ์เครือข่าย","บอร์ดทดลอง","อุปกรณ์วัด"] %}

{% block content %}
<div style="margin-left:260px; margin-right:24px; padding:24px;">
  <h1 style="font-size:22px; font-weight:700; margin:0 0 16px;">แก้ไขอุปกรณ์</h1>

  <form action="{{ url_for('inventory.admin_equipment_edit', eid=item.equipment_id) }}"
        method="post" enctype="multipart/form-data"
        style="background:#f6f6f6; border:1px solid #cfcfcf; border-radius:12px; padding:24px; max-width:600px;">

    <label>ชื่ออุปกรณ์ *</label>
    <input class="ctrl" type="text" name="name" required value="{{ item.name }}">

    <label style="margin-top:12px;">รหัส/หมายเลข *</label>
    <input class="ctrl" type="text" name="code" required value="{{ item.code }}">

    <label style="margin-top:12px;">หมวดหมู่</label>
    <select class="ctrl" name="category">
      <option value="">— เลือกหมวดหมู่ —</option>
      {% for c in CATEGORIES %}
        <option value="{{ c }}" {% if item.category==c %}selected{% endif %}>{{ c }}</option>
      {% endfor %}
    </select>

    <label style="margin-top:12px;">ยี่ห้อ</label>
    <input class="ctrl" type="text" name="brand" value="{{ item.brand or '' }}">

    <label style="margin-top:12px;">รายละเอียด</label>
    <textarea class="ctrl" name="detail" rows="4">{{ item.detail or '' }}</textarea>

    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:12px;">
      <div>
        <label>วันที่ซื้อ</label>
        <input class="ctrl" type="date" name="buy_date" value="{{ item.buy_date }}">
      </div>
      <div>
        <label>สถานะ</label>
        <select class="ctrl" name="status">
          {% for s in ["available","in_use","broken","lost"] %}
            <option value="{{ s }}" {% if item.status==s %}selected{% endif %}>{{ s }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <label style="margin-top:12px;">แนบรูปภาพ (เพิ่มรูปใหม่)</label>
    <input class="ctrl" type="file" name="image" accept="image/*">

    {% if item.images and item.images[0].image_path %}
      <div style="margin-top:12px;">
        <div style="font-size:13px; color:#666; margin-bottom:6px;">รูปปัจจุบัน</div>
        <img src="{{ url_for('static', filename=item.images[0].image_path) }}" style="width:120px; height:120px; border-radius:8px; object-fit:cover;">
      </div>
    {% endif %}

    <div style="text-align:right; margin-top:18px;">
      <a class="btn" href="{{ url_for('inventory.admin_equipment_list') }}" style="padding:10px 18px; border:1px solid #ccc; border-radius:8px; text-decoration:none;">ยกเลิก</a>
      <button type="submit" class="btn primary" style="padding:10px 18px; border-radius:8px; background:#4caf50; color:#fff; border:0;">บันทึก</button>
    </div>
  </form>
</div>
{% endblock %}
